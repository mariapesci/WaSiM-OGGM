# control file for topographic analysis
# lines starting with # are comments
# an asterixs '*' instead of a file name or at the beginning of a line means that the file will not be calculated
# files that are created by Tanalys internally (e.g. slope) will be used for later calculation of dependent entities
# only if if not found, they are looked for on the hard disk

$set $Path                = E:\DIRT_X\Gepatsch\Gepatschalm\input\
$set $Grid                = alm
$set $Threshold           = 20         # threshold depends on resolution and size of the features you would like to see
$set $Manning             = 25
$set $specificRunoff      = 103.4

$set $DEM                 = //$Grid//.dem
$set $RiverNetwork        = //$Grid//.lin
$set $Flowdirection       = //$Grid//.fld
$set $Flowaccumulation    = //$Grid//.acc
$set $RiverLinksNumbered  = //$Grid//.num
$set $RiverOrders   	  = //$Grid//.ord


[Hoehenmodell]		# DEM
1                       # switch 0=do not read in, 1= read in (strongly recommended here to read the DEM in)
$Path//$DEM             # path to the DEM file

[Aspect]		# exposition
1                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.exp      # result grid Aspect

[Gefaelle]		# slope
1                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.slp      # result grid slope

[Horizont]		#sky view factor
1                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.hor      # result grid sky view factor
12                      # number of sectors of the full circle to caculate average sky visibility

[WindCorrectionFactor]  # used for snow correction in snow model of WaSiM
1			# 0=do not process this section, 1=process this section
$Path//$Grid//.svfdir   # result grid: sky view factor for a limited sector of a circle (directed svf). Attention: the real wind redistribution factor is a grid with the same name but suffix _2 for the extension.
10			# number of sectors to subdivide the limited sector for integrating the sky view factor 
180			# start azimuth (0=North, 90=East, 180=South etc.)
270			# end azimuth for the directed svf
2.0			# maximum deposition index: 2 means that for an evenly distributed terrain the deposition index will vary between 0 and 2 with an average of 1, so no effective increase of snow fall will be present. values larger than 2 result in an effective snow fall increase, value less than 2 (but greater than 0) in a decrease
2000			# elevation offset: the larger this number, the more additional snow will even the low elevation cells get since they are handled as if they were higher (by this offset)
0.3			# Minimum remaining snow (shifts the correction factor globally)

[SnowRedistribution]	# snow redistribution input grids
1
$Path//$Grid//.sd1	# result grid: weighed fraction for flow direction 1 (North)
$Path//$Grid//.sd2	# result grid: weighed fraction for flow direction 2 (West)
$Path//$Grid//.sd3	# result grid: weighed fraction for flow direction 3 (East)
$Path//$Grid//.sd4	# result grid: weighed fraction for flow direction 4 (South)
$Path//$Grid//.eoc	# result grid: elevation order (colums)
$Path//$Grid//.eor	# result grid: elevation order (rows)

[Profilcurvature]	
0                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.prc      # result grid Profilcurvature

[Plancurvature]
0                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.plc      # result grid Plancurvature

[Curvature]
0                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.cur      # result grid Curvature

[Flowdirection]		
1                        # switch 0=do not calculate, 1=calculate this section with 8 flow directions (1=NE, 2=E, 4=SE, 8=S, 16=SW, 32=W, 64=NW, 128=N); 2= use 4 directions only (usefull for new surface routing) with 2=E, 8=S, 32=W, 128=N
$Path//$Flowdirection    # result grid corrected flow directions
$Path//$Grid//.sin       # result grid sinks
$Path//$Grid//.dhk       # result grid corrected DEM (filled sinks)

[Flowaccumulation]
1                        # switch 0=do not calculate, 1=calculate this section
$Path//$Flowaccumulation # result grid flow accumulation
$Path//$Flowdirection    # input grid flow direction
$Threshold               # Threshold for creating a river (minimum number of accumulated cells)

[Flussnetz]		 # river network	
1                        # switch 0=do not calculate, 1=calculate this section
$Path//$RiverNetwork     # result grid river network
$Path//$Flowaccumulation # input grid flow accumulation
$Threshold               # Threshold for creating a river (minimum number of accumulated cells)

[Flussordnungen]	   # river orders (Strahler)
1                          # switch 0=do not calculate, 1=calculate this section
$Path//$RiverOrders        # result grids river orders
$Path//$RiverLinksNumbered # result grid with numbered river links
$Path//$RiverNetwork       # input grid river network
$Path//$Flowdirection      # input grid flow directions

[Fliesskorrektur]
1                        # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.ork       # result grid corrected river orders
$Path//$Grid//.nuk       # result grid corrected river links (numbered)
$Path//$Grid//.flk       # result grid corrected flow directions
$Path//$Grid//.ack       # result grid corrected flow accumulations
$Threshold		 # threshold as described above
$Path//$DEM     	 # input grid DEM
$Path//$RiverOrders   	 # input grid original river orders
$Path//$Flowdirection    # input grid original flow directions
$Path//$Flowaccumulation # input grid original flow accumulations
$Path//$RiverNetwork     # input grid original network
5                      # number of correction runs (recommended are at least 2 * first order and 2 * 2nd order und 1 * third order
1                      # river order for 1st correction
2                      # river order for 2nd correction
1                      # river order for 3rd correction
3                      # etc.
1                      # etc. (up to the counter defined as first parameter)

[Fliesszeiten]		# flow travel times
1                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.fzt      # result grid flow travel times
$Path//$Grid//.dep      # result grid river depths
$Path//$Grid//.wit      # result grid river widths
$Manning                # roughness coefficient (Manning)
$specificRunoff         # specific discharge in l/s/km^2 for creating river bed geometry
$Path//$Grid//.dhk      # input grid corrected elevation model
$Path//$Grid//.slp      # input grid slope
$Path//$Grid//.flk      # input grid flow direction (corrected)
$Path//$Grid//.ack      # input grid flow accumulation (corrected)
$Path//$Grid//.nuk      # input grid numgered river links (corrected)

[Flusseparation]	# river separation (mouths for later creation of sub-basins)
0                       # switch 0=do not calculate, 1=calculate this section
$Path//$Grid//.m        # result grid with pourpoints (mouths)
1                       # smallest river order for calculating pourpoints
6                       # highest river order for calculating pourpoints
$Path//$Grid//.ork      # input grid corrected river orders
$Path//$Grid//.nuk      # input grid corrected numbered river links (will contain the later subbasin codes)
$Path//$Grid//.flk      # input grid corrected flow directions

[Einzugsgebiete]	# sub basins
1                       # switch 0=do not calculate, 1=calculate this section
$Manning		# Manning roughness coefficient
$specificRunoff		# specific runoff as used for geomotry (here used for creation of hydraulic parameters)
$Path//$Grid//.dhk      # input grid corrected elevation model
$Path//$Grid//.ack      # input grid corrected flow accumulation
$Path//$Grid//.flk      # input grid corrected flow direction
$Path//$Grid//.fzt      # input grid flow travel time
1                          # Anzahl an zu berechnenden basin-Grids, #$Path//$Grid//.m02
$Path//$Grid//.pur       # das Pegelnetzgrid
$Path//$Grid//.ezg       # Ergebnisgrid Pegeleinzugsgebiete
$Path//$Grid//.fzs       # Ergebnisgrid Fliesszeitsummen Pegelgebiete
$Path//$Grid//.lnk       # Ergebnisgrid Markierungen der Routingstrecken
$Path//$Grid//stru.ezg   # Entwaesserungsstruktur als Textdatei fuer Grid m500.pur

#$Path//$Grid//.m01         # pourpoints order 1
#$Path//$Grid//.e01         # result grid subbasins order 1
#$Path//$Grid//.fzs01       # result grid flow travel time sums order 1
#$Path//$Grid//.lnk01       # result grid routing channels order 1
#$Path//$Grid//stru_01.ezg  # routing dsescriptions in WaSiM format (do not use these but rather a structure derived from real world station coordinates, see below)
#$Path//$Grid//.m02         # pourpoints order 2
#$Path//$Grid//.e02         # result grid subbasins order 2
#$Path//$Grid//.fzs02       # result grid flow travel time sums order 2
#$Path//$Grid//.lnk02       # result grid routing channels order 2
#$Path//$Grid//stru_02.ezg  # routing dsescriptions in WaSiM format (do not use these but rather a structure derived from real world station coordinates, see below)
#$Path//$Grid//.m03         # pourpoints order 3
#$Path//$Grid//.e03         # result grid subbasins order 3
#$Path//$Grid//.fzs03       # result grid flow travel time sums order 3
#$Path//$Grid//.lnk03       # result grid routing channels order 3
#$Path//$Grid//stru_03.ezg  # routing dsescriptions in WaSiM format (do not use these but rather a structure derived from real world station coordinates, see below)
#$Path//$Grid//.m04         # pourpoints order 4
#$Path//$Grid//.e04         # result grid subbasins order 4
#$Path//$Grid//.fzs04       # result grid flow travel time sums order 4
#$Path//$Grid//.lnk04       # result grid routing channels order 4
#$Path//$Grid//stru_04.ezg  # routing dsescriptions in WaSiM format (do not use these but rather a structure derived from real world station coordinates, see below)
#$Path//$Grid//.m05         # pourpoints order 5
#$Path//$Grid//.e05         # result grid subbasins order 5
#$Path//$Grid//.fzs05       # result grid flow travel time sums order 5
#$Path//$Grid//.lnk05       # result grid routing channels order 5
#$Path//$Grid//stru_05.ezg  # routing dsescriptions in WaSiM format (do not use these but rather a structure derived from real world station coordinates, see below)
#$Path//$Grid//.m06         # pourpoints order 6
#$Path//$Grid//.e06         # result grid subbasins order 6
#$Path//$Grid//.fzs06       # result grid flow travel time sums order 6
#$Path//$Grid//.lnk06       # result grid routing channels order 6
#$Path//$Grid//stru_06.ezg  # routing dsescriptions in WaSiM format (do not use these but rather a structure derived from real world station coordinates, see below)

#1			# count of following sequences for sub basin generation
#$Path//$Grid//.purglac      # first pourpoint grid
#$Path//$Grid//.ezg2      # result grid sub basins for the above pourpoints
#$Path//$Grid//.fzs      # result grid flow travel time sums
#$Path//$Grid//.lnk      # result grid routing channels for WaSiM
#$Path//$Grid//struct.ezg # result file with routing descriptions for this specific pourpoints to be copied into WaSiMs control file at the end of section [runoff_routing]


#instead of calculating various subbasin grids for different river orders, a redefined pourpoint grid could be provided (e.g. hydrometric stations) to calculate the subbasins for the final model domain
1			# count of following sequences for sub basin generation
$Path//$Grid//.pur      # first pourpoint grid
$Path//$Grid//.ezg      # result grid sub basins for the above pourpoints
$Path//$Grid//.fzs      # result grid flow travel time sums
$Path//$Grid//.lnk      # result grid routing channels for WaSiM
$Path//$Grid//struct.ezg # result file with routing descriptions for this specific pourpoints to be copied into WaSiMs control file at the end of section [runoff_routing]
